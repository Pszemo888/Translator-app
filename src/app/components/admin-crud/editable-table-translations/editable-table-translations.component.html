<div class="translations-container">
    <h3>Translations list</h3>
    
    <form [formGroup]="editForm">
    <table  class="translations-table">
      <thead>
        <tr>
          <th>ID</th>
          <th
          [class.active-asc]="sortKey === 'sourceText' && sortDirection === 'asc'"
          [class.active-desc]="sortKey === 'sourceText' && sortDirection === 'desc'"
          (click)="sortTable('sourceText')">
          Source Text
         </th>
        
          <th>Translated text</th>
          <th>Source language</th>
          <th>Target language</th>
         
          <th
          [class.active-asc]="sortKey === 'createdAt' && sortDirection === 'asc'"
          [class.active-desc]="sortKey === 'createdAt' && sortDirection === 'desc'"
          (click)="sortTable('createdAt')">
          Creation Date
          </th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        @for (translation of (showAll ? translations : translations.slice(0, initialDisplayCount)); track translation._id; let i = $index) {
          <tr>
            <td>{{ $index + 1 }}</td>
            <td>{{ translation.sourceText }}</td>
            <td>{{ translation.translatedText }}</td>
            <td>{{ translation.sourceLanguage }}</td>
            <td>{{ translation.targetLanguage }}</td>
            <td>{{ translation.createdAt | date: 'yyyy-MM-dd HH:mm' }}</td>  
              <td>
                <button (click)="startEditing(translation)">Edit</button>
                <button (click)="deleteTranslation(translation._id )">Delete</button>
            </td>
          </tr>
        }
      </tbody>

    </table>
  </form>
 
  <div class="toggle-button">
    <button (click)="toggleShowAll()">
      {{ showAll ? 'Show Less' : 'Show More' }}
    </button>
  </div>

</div>
  

@if (isDialogOpen) {
  <div class="dialog-overlay">
    <div class="dialog">
      <h2>Edit translations</h2>

      
      <form [formGroup]="editForm">
        <label for="sourceText">Source text</label>
        <input id="sourceText" formControlName="sourceText" />

        <label for="translatedText">Translated text</label>
        <input id="translatedText" formControlName="translatedText" />

        <label for="sourceLanguage">Source Language</label>
        <select id="sourceLanguage" formControlName="sourceLanguage">
          <option value="" disabled selected>Select Source Language</option>
          @for (lang of languages; track $index) {
            <option [value]="lang.code">{{ lang.name }}</option>
          }
        </select>
        
        <label for="targetLanguage">Target Language</label>
        <select id="targetLanguage" formControlName="targetLanguage">
          <option value="" disabled selected>Select Target Language</option>
          @for (lang of languages; track $index) {
            <option [value]="lang.code">{{ lang.name }}</option>
          }
        </select>

        <div class="dialog-actions">
          <button (click)="closeDialog()" type="button">Cancel</button>
          <button (click)="saveEdit()" type="button">Save</button>
          
        </div>
        @if (errorMessage) {
          <div class="error-message">
            {{ errorMessage }}
          </div>
        }
      </form>
    </div>
   
  </div>
}